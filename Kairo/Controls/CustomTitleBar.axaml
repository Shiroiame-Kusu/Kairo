<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             x:Class="Kairo.Controls.CustomTitleBar"
             x:Name="Root"
             Height="36">
  <UserControl.Styles>
    <Style Selector="Button.TitleBarButton">
      <Setter Property="Background" Value="Transparent"/>
      <Setter Property="BorderBrush" Value="Transparent"/>
      <Setter Property="Foreground" Value="{DynamicResource TextFillColorPrimaryBrush}"/>
      <Setter Property="CornerRadius" Value="4"/>
      <Setter Property="Padding" Value="0"/>
    </Style>
    <Style Selector="Button.TitleBarButton:pointerover">
      <Setter Property="Background" Value="{DynamicResource ControlFillColorSecondaryBrush}"/>
    </Style>
    <Style Selector="Button.TitleBarButton:pressed">
      <Setter Property="Background" Value="{DynamicResource ControlFillColorTertiaryBrush}"/>
    </Style>
    <Style Selector="Button.TitleBarButton.Close:pointerover">
      <Setter Property="Background" Value="#E81123"/>
      <Setter Property="Foreground" Value="White"/>
    </Style>
    <Style Selector="Button.TitleBarButton.Close:pressed">
      <Setter Property="Background" Value="#C50F1F"/>
    </Style>
  </UserControl.Styles>
  <Border Background="{DynamicResource LayerFillColorDefaultBrush}" Padding="12,0,8,0">
    <Grid ColumnDefinitions="Auto,8,*,Auto,Auto,Auto,Auto" Height="36">
      <!-- App Icon -->
      <Image Source="avares://Kairo/Assets/kairo.ico" Width="20" Height="20" VerticalAlignment="Center"/> 
      <!-- Title -->
      <TextBlock Grid.Column="2" Text="{Binding Title, ElementName=Root}" VerticalAlignment="Center" FontSize="14" FontWeight="SemiBold" />
      <!-- User Avatar and Name (optional, controlled by ShowUserInfo) -->
      <StackPanel x:Name="UserInfoPanel" Grid.Column="3" Orientation="Horizontal" VerticalAlignment="Center" Spacing="8" Margin="0,0,12,0" IsVisible="False">
        <Border Height="24" Width="24" CornerRadius="12" ClipToBounds="True">
          <Image x:Name="UserAvatar" Source="avares://Kairo/Assets/kairo.ico" Stretch="UniformToFill"/>
        </Border>
        <TextBlock x:Name="UserNameText" Text="" VerticalAlignment="Center" FontSize="12"/>
      </StackPanel>
      <StackPanel Grid.Column="4" Orientation="Horizontal" VerticalAlignment="Center" Spacing="4">
        <!-- Minimize Button -->
        <Button Classes="TitleBarButton" Click="Minimize_Click" Width="36" Height="28" Content="_"/>
      </StackPanel>
      <Button Grid.Column="5" Classes="TitleBarButton" Click="MaxRestore_Click" Width="36" Height="28">
        <ContentControl x:Name="MaxIcon" Content="▢" HorizontalAlignment="Center" VerticalAlignment="Center"/>
      </Button>
      <Button Grid.Column="6" Classes="TitleBarButton Close" Click="Close_Click" Width="44" Height="28">
        <ContentControl Content="✕" HorizontalAlignment="Center" VerticalAlignment="Center"/>
      </Button>
    </Grid>
  </Border>
</UserControl>
